var g_FADE_TIME=400;function hasTouchSupport(){return navigator.msMaxTouchPoints>0}function isTabletDevice(){var a=document.createElement("div");a.setAttribute("ongesturestart","return;");return typeof a.ongesturestart==="function"?!0:!1}
var VF_SINGLE=0,VF_DOUBLE=1,VF_RIGHT=2,VF_PGLOAD=3,WARNING=0,SAVED=1,REMINDER=2,LOADING=3,agt=navigator.userAgent.toLowerCase(),is_major=parseInt(navigator.appVersion,10),is_minor=parseFloat(navigator.appVersion,10),is_opera=agt.indexOf("opera")!=-1,is_chrome=agt.indexOf("chrome")!=-1,is_gecko=agt.indexOf("gecko")!=-1&&!is_chrome,is_safari=agt.indexOf("safari")!=-1,is_nav=agt.indexOf("mozilla")!=-1&&agt.indexOf("spoofer")==-1&&agt.indexOf("compatible")==-1&&agt.indexOf("opera")==-1&&agt.indexOf("webtv")==
-1&&agt.indexOf("hotjava")==-1,is_nav2=is_nav&&is_major==2,is_nav3=is_nav&&is_major==3,is_nav4=is_nav&&is_major==4,is_nav4up=is_nav&&is_major>=4,is_navonly=is_nav&&(agt.indexOf(";nav")!=-1||agt.indexOf("; nav")!=-1),is_nav6=is_nav&&is_major==5,is_nav6up=is_nav&&is_major>=5;is_ff30Plus=agt.split("/")[2].indexOf("firefox")!==-1&&parseInt(agt.split("/")[3])>=30;
var is_ie=isIE=ie=agt.indexOf("msie")!=-1&&!is_opera&&!is_nav,is_ie3=is_ie&&is_major<4,is_ie4=is_ie&&is_major==4&&agt.indexOf("msie 5.0")==-1&&agt.indexOf("msie 5.5")==-1&&agt.indexOf("msie 6.0")==-1&&agt.indexOf("msie 6.5")==-1,is_ie4up=is_ie&&is_major>=4,is_ie5=is_ie&&is_major==4&&agt.indexOf("msie 5.0")!=-1,is_ie5up=is_ie&&is_major>=5,is_ie55=is_ie&&is_major==4&&agt.indexOf("msie 5.5")!=-1,is_ie55up=is_ie&&!is_ie3&&!is_ie4&&!is_ie5,is_ie6=is_ie&&is_major==4&&agt.indexOf("msie 6.0")!=-1,is_ie7=
is_ie&&is_major==4&&agt.indexOf("msie 7.0")!=-1,is_ie7up=is_ie&&is_major>=7,is_ie8=is_ie&&is_major==4&&agt.indexOf("msie 8.0")!=-1||is_ie7&&agt.indexOf("trident")!=-1;is_ie8up=is_ie&&is_major>=8;is_ie9=is_ie&&agt.indexOf("msie 9.0")!=-1;is_ie9up=!1;is_ie10=is_ie&&agt.indexOf("msie 10.0")!=-1;is_ie11=agt.indexOf("trident")!=-1&&!is_opera;is_ie12=(is_ie=is_ie||is_ie11)&&agt.indexOf("msie 12.0")!=-1;if(is_ie7||is_ie8)is_ie7up=is_ie55up=!0;if(is_ie8||is_ie9||is_ie10||is_ie11||is_ie12)is_ie8up=!0;
if(is_ie9||is_ie10||is_ie11||is_ie12)is_ie9up=!0;is_standard=is_gecko||is_ie8;var is_mac=agt.indexOf("mac")!=-1,agt=navigator.userAgent.toLowerCase(),moz=navigator.product=="Gecko"&&!/Safari/.test(navigator.userAgent),isOpera=agt.indexOf("opera")!=-1,isSafari=/Safari/.test(navigator.userAgent),isWin=navigator.appVersion.toLowerCase().indexOf("win")!=-1,isMac=/Mac/.test(navigator.userAgent),is_iPhone=/iPhone/.test(navigator.userAgent);is_ipad=/ipad/.test(agt);is_playbook=/playbook/.test(agt);
is_tablet=is_ipad||is_playbook||isTabletDevice();g_IS_TOUCH_ENABLED=is_tablet||hasTouchSupport();g_ENDLESS_PAGE_HEIGHT=(g_IS_TOUCH_ENABLED?40:20)*50;
try{if(!is_opera){Event.prototype.__defineGetter__("srcElement",function(){if(typeof window.event!="undefined"){var a=window.event.target;if(a.nodeType)for(;a.nodeType!=1;)a=a.parentNode;return a}});Event.prototype.__defineGetter__("offsetX",function(){return typeof window.event=="undefined"?void 0:window.event.layerX});Event.prototype.__defineGetter__("offsetY",function(){return typeof window.event=="undefined"?void 0:window.event.layerY});for(var events=["mousemove","contextmenu"],i=2;i--;)document.addEventListener(events[i],
function(a){if(typeof window.event!="undefined")window.event=a},!0)}}catch(exception){}var CLASS=is_ie?"className":"class";function getEl(a){return document.getElementById(a)}function Mesg(a){StatusMsg();a.length>0&&alert(a)}function StatusMsg(a){try{a!=null?top.showStatusMessage(sStatusMesg):getEl("StatusMesg")&&getEl("StatusMesg").innerHTML.length>0&&top.showStatusMessage(getEl("StatusMesg").innerHTML)}catch(b){}}
function Post(a,b,c){document.forms[c?c:0].action+="&"+(a!=null?a:"No")+"="+(b!=null?b:"Yes");if(typeof Validate=="undefined"||Validate())document.forms[c?c:0].submit()}function Get(a,b,c){document.location=document.forms[c?c:0].action+"&"+a+"="+(b!=null?b:"Yes")}
function SetOption(a,b){for(var b=new String(b),c=document.forms.length,d=document.forms[0];c--;)for(var d=document.forms[c],e=d.length,f=e;f--;)if(d.elements[f].name==a){var g=d.elements[f];break}if(g!=null)switch(g.type){case "checkbox":g.checked=g.value==b;break;case "radio":for(f=e;f--;)if(d.elements[f].name==a&&d.elements[f].value==b)d.elements[f].checked=!0;break;case "select-one":for(f=g.length;f--;)if(g.options[f].value.toLowerCase()==b.toLowerCase())g.selectedIndex=f;break;case "select-multiple":for(f=
g.length;f--;)if(g.options[f].value.toLowerCase()==b.toLowerCase())g.options[f].selected=!0;break;case "text":g.value=b;break;case "hidden":g.value=b}}function SelectAll(){MsgSelected.length=0;for(var a=document.forms[0],b=document.forms[0].elements.length,c=null;b--;)if(c=a.elements[b],c.name=="Number")c.checked=!0,highlight(c.value),MsgSelected.push(c.value)}
function EnableFormFields(a,b){for(var c=b.length,d;c--;){if(!b[c])break;d=b[c];if(d.tagName!="FIELDSET"){if(d.tagName!="TEXTAREA"&&d.type!="text")d.disabled=a?!1:!0;d.readOnly=a?!1:!0}}}function SetCookie(a,b){document.cookie=a+"="+b+";expires="+new Date(2020,12,31)}function GetCookie(a){for(var b=document.cookie.split("; "),c=b.length;c--;){var d=b[c].split("=");if(a==d[0])return d[1]}return null}
function DeleteCookie(a){if(GetCookie(a))document.cookie=a+"=;expires=Thu, 01-Jan-1970 00:00:01 GMT"}function Print(a,b){window.open(a,b?"Source":"Print","height=400,width=600,scrollbars=yes,status=yes,resizable=1,toolbar=yes,menubar=yes")}function Source(a){Print(a,1)}
function openWin(a,b,c,d,e){a=window.open(a,b+(e=="compose"?top.composeWindowCount++:""),"directories=no,location=no,menubar=no,status=no,scrollbars="+(e=="yes"||e=="compose"?"yes":"no")+",resizable="+(e=="yes"||e=="compose"?"yes":"no")+",titlebars=no,toolbar=no,width="+c+",height="+d);a.focus();if(!a.opener)a.opener=window;return a}
function openModalWin(a,b,c,d,e,f,g){e||(e="no");f||(f="no");d||(d="yes");if(is_ie)return g||(g=window),b="dialogHeight:"+c+"px;dialogWidth:"+b+"px;edge:Raised;center:Yes;help:No;resizable:"+d+";status:"+e+";scroll:"+f+";",a.substring(a.indexOf("=")+1,a.indexOf("&")),a=a.substring(0,a.indexOf("View="))+"View=ModalFrame&file="+a.substring(a.indexOf("View=")+5),window.showModalDialog(a,g,b);else g="modal,width="+(b?b:screen.availWidth*0.75)+",height="+(c?c-30:screen.availHeight*0.75)+",status="+e+",resizable="+
d+",scrollbars="+f+",menubar=no,toolbar=no",window.open(a,Math.random(),g)}function openHelp(){if(!opener)return top.openHelp(),!1}function xmlHTTP(a,b,c,d){a=replaceURLVar(a,"XMLHTTP","1");b&&b.length>0?jQuery.post(a,b,c?c:afterPost,d?"xml":"text"):jQuery.get(a,"",c?c:afterPost,d?"xml":"text")}function afterPost(a,b){if(b==="error"||b==="parseerror")try{top.writeToDebugLog("AJAX error: "+b)}catch(c){}else if(b==="success")try{eval(""+a+"")}catch(d){}}
function findURLVar(a,b){var c,d;b.charAt(b.length)!="="&&(b+="=");c=a.indexOf(b);c!=0&&(c=a.indexOf("&"+b),c==-1&&(c=a.indexOf("?"+b)));return c!=-1?((a.charAt(c)=="&"||a.charAt(c)=="?")&&c++,c+=b.length,d=a.indexOf("&",c),unescape(d==-1?a.substring(c):a.substring(c,d))):""}
function replaceURLVar(a,b,c){if(!a)return new String;if(!b)return new String;var d=new String;b.charAt(b.length)!="="&&(b+="=");start=a.indexOf(b);start!=0&&(start=a.indexOf("&"+b));start==-1?(d=a,c!=null&&(d+=a.indexOf("?")==-1&&a.indexOf("&")==-1?"?":"&",d+=b,d+=encodeURIComponent(c))):(c!=null&&(a.charAt(start)=="&"&&start++,start+=b.length),d=a.substring(0,start),d+=encodeURIComponent(c),b=a.indexOf("&",start),b!=-1&&(d+=a.substring(b,a.length)));return d}
function removeURLVar(a,b){var c=a.indexOf("?");if(c==-1)return a;for(var d=a.substr(0,c+1),c=a.substr(c+1).split("&"),e=0;e<c.length;)c[e].split("=")[0]!=b&&(d+=(e==0?"":"&")+c[e]),++e;return d}function removeChildren(a){if(a)is_ie?ieremoveChildren(a):a.innerHTML=""}function ieremoveChildren(a){for(var b=a.childNodes,c=b.length;c--;)a.removeChild(b[c])}
function validateIntKey(a){if(!a)a=window.event;return a.keyCode==8||a.keyCode==9||a.keyCode==46||a.keyCode>=48&&a.keyCode<=57||a.keyCode>=96&&a.keyCode<=105?(typeof setIsDirty!="undefined"&&setIsDirty(),!0):!1}function getTopOffset(a){for(var b=a.offsetTop;a.offsetParent!=null;)b+=a.offsetParent.offsetTop,a=a.offsetParent;return b}function getLeftOffset(a){for(var b=a.offsetLeft;a.offsetParent!=null;)b+=a.offsetParent.offsetLeft,a=a.offsetParent;return b}
try{var liObj=document.createElement("li"),ulObj=document.createElement("ul"),aObj=document.createElement("a"),divObj=document.createElement("div"),spanObj=document.createElement("span"),imgObj=document.createElement("img"),inputObj=document.createElement("input"),labelObj=document.createElement("label"),tableObj=document.createElement("table"),theadObj=document.createElement("thead"),tfootObj=document.createElement("tfoot"),tbodyObj=document.createElement("tbody"),trObj=document.createElement("tr"),
thObj=document.createElement("th"),tdObj=document.createElement("td"),iconObj=document.createElement("i")}catch(ex$$2){}function clone(a){return a.cloneNode(1)}var bodyWidth,bodyHeight,g_scrollBarWidth=20;
function getPageDimensions(){if(self.innerHeight)bodyWidth=self.innerWidth,bodyHeight=self.innerHeight;else if(document.documentElement&&document.documentElement.clientHeight)bodyWidth=document.documentElement.clientWidth,bodyHeight=document.documentElement.clientHeight;else if(document.body)bodyWidth=document.body.clientWidth,bodyHeight=document.body.clientHeight;detectScrollBarDimensions()}var bScrollBarTested=0;
function detectScrollBarDimensions(){if(!(bScrollBarTested++>50)){try{var a=$('<span style="visibility:hidden;overflow:scroll;width: 0;display:block;"></span>');$("body").append(a);g_scrollBarWidth=a[0].offsetWidth-a[0].clientWidth;$(a).remove()}catch(b){g_scrollBarWidth=15}g_scrollBarWidth>20&&(g_scrollBarWidth=20)}}
var statusIndicator={init:function(a,b){var c=this;this.text=a;this.delay=b;if(this.timer)clearTimeout(this.timer),this.timer=null;this.timer=window.setTimeout(function(){c.show()},c.delay)},show:function(){$("#container").append('<div id="statusIndicator" class="statusIndicator"><div class="ieHack"><i class="icon-spinner icon-spin icon-large"></i>'+this.text+"</div></div>")},hide:function(){if(this.timer)clearTimeout(this.timer),this.timer=null;getEl("statusIndicator")&&getEl("container").removeChild(getEl("statusIndicator"))}};
function disableSelection(a){a.onselectstart=function(a){if(!a)a=window.event;var c=a.srcElement?a.srcElement.tagName:a.target.tagName;return c=="INPUT"||c=="TEXTAREA"||$(a.target).hasClass("selectable")?!0:!1};$(a).addClass("noSelection");a.unselectable="on";a.style.MozUserSelect="none";a.style.webkitUserSelect="none";a.style.cursor="default"}
function enableSelect(a){a.onselectstart=function(){var a=window.event.srcElement.tagName;return a=="INPUT"||a=="TEXTAREA"?!0:!1};a.unselectable="off";a.style.MozUserSelect="normal";a.style.cursor=""}function opacity(a,b,c,d){var d=Math.round(d/100),e=0;if(b>c)for(i=b;i>=c;i--)setTimeout("changeOpacity("+i+",'"+a+"')",e*d),e++;else if(b<c)for(i=b;i<=c;i++)setTimeout("changeOpacity("+i+",'"+a+"')",e*d),e++}
function changeOpacity(a,b){if(getEl(b)){var c=getEl(b).style;c.opacity=a/100;c.MozOpacity=a/100;c.KhtmlOpacity=a/100;c.filter="alpha(opacity="+a+")"}}function getParentByTagName(a,b){for(var c=a;c.tagName!=b;)c=c.parentNode;return c}function getParentByClassName(a,b){for(var c=a,d=c.className;d.indexOf(b)==-1;)c=c.parentNode,d=c.className;return c}
function getPrettyTime(a){a||(a=new Date);var b=a.getHours(),a=a.getMinutes(),c=(useAMPM?b==0?12:b<13?b:b-12:b)+":";c+=(a<10?"0":"")+a+(useAMPM?b<12?" "+translate("AM"):" "+translate("PM"):"");return c}function getPrettyDate(a,b){var c;c=dateFormatString.split("").join("/");c=dateFormat(c,a.getFullYear(),a.getMonth()+1,a.getDate());return c+(b!==!1?" "+getPrettyTime(a):"")}function zeroPadded(a){return(a<10?"0":"")+a}
function getISOFormattedDate(a){return a.getFullYear()+"-"+zeroPadded(a.getMonth())+"-"+zeroPadded(a.getDate())+" "+zeroPadded(a.getHours())+":"+zeroPadded(a.getMinutes())}function dateFormat(a,b,c,d){a=a.replace("y",b).replace("Y",b);a=a.replace("d",d);return a=a.replace("m",c)}
function getDateObjectFromDateString(a){var b=a;if(a.indexOf("[")!==-1)return translate("Invalid Date");var c,d,a=g_DateFormat.indexOf("/")!==-1?a.replace(/\s/g,"/").replace(":","/").split("/"):a.replace(/\s/g,"-").replace(":","-").split("-");switch(g_DateFormat){case "m/d/Y":case "m-d-Y":b=a[2];c=a[0];d=a[1];break;case "d/m/Y":case "d-m-Y":b=a[2];c=a[1];d=a[0];break;case "Y/m/d":case "Y-m-d":b=a[0];c=a[1];d=a[2];break;default:return b}return new Date(parseInt(b,10),parseInt(c,10)-1,parseInt(d,10),
parseInt(a[3],10)+(a[5]==translate("PM")&&parseInt(a[3])<12?12:0),parseInt(a[4],10))}function encodeHTML(a){return a.replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace(/\"/g,"&quot;")}function unencodeJSON(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&nbsp;/g," ")}function stripHTML(a){return a.replace(/<.*?>/gm,"")}function preventXSS(a){return encodeHTML(stripHTML(a))}
function arrayUnique(a){for(var b=[],c=0;c<a.length;c++)b.indexOf(a[c])==-1&&b.push(a[c]);return b}function parseAddressList(a){for(var a=$.trim(a),b=[];a.length>0;){for(var c=!1,d=0;d<a.length;){var e=a[d];if(e=='"')c=!c;else if(!(e=="\\"&&d+1!=a.length)&&(e==";"||e==",")&&!c)break;d++}c=a.substr(0,d);a=a.substr(d+1);$.trim(c);c.length>0&&b.push(c)}return b}
function formatEmailAddresses(a){a=parseAddressList(a);for(string in a){a[string]=$.trim(a[string]);if(a[string].indexOf('"')==-1&&(getNameAndEmailFieldsFromEmail(a[string]).name.length>0?a[string]=a[string].replace(getNameAndEmailFieldsFromEmail(a[string]).name,'"'+getNameAndEmailFieldsFromEmail(a[string]).name+'"'):a[string].indexOf("(")!=-1&&(a[string]=a[string].replace("(",'"').replace(")",'"')),a[string].indexOf("<")==-1)){var b=a[string].match(/(\S+@\S+.\w+)/g);a[string]=a[string].replace(b,
"<"+b+">")}a[string].indexOf("'")!=-1&&(a[string]=a[string].replace(/'/g,""));a[string].indexOf("<")==0&&(b=a[string].match(/(<\S+@\S+.\w+>)/g),a[string]=a[string].substring(a[string].indexOf(">")+1)+" "+b)}return a}function createEmailContextTriggers(a){a=formatEmailAddresses(a);sHTML="";for(var b=0,c=a.length;b<c;)sHTML+='<span class="emailAddress selectable">'+encodeHTML(a[b++])+"</span>"+(b<c?", ":"");return sHTML}
function getNameAndEmailFieldsFromEmail(a){var b={name:"",email:""},a=$.trim(a),a=a.replace('<span class="bold">','"').replace("</span>",'"'),c=a.lastIndexOf("<"),d=a.lastIndexOf(">");c==-1||d<c?b.email=a:(b.email=a.substring(c+1,d),b.name=a.substring(0,c).replace(/\s+$/,"").replace(/^"/,"").replace(/"$/,""));return b}
function addToBlacklist(a){var b=getNameAndEmailFieldsFromEmail(a),a="&View=ContactEdit&Create=1&External=Yes&FolderID="+g_BLACKLIST_FOLDERID+"&Save=Yes",b="&guid=&mail="+encodeURIComponent(b.email)+"&cn="+encodeURIComponent(b.name);$.ajax({url:wcLink+a,data:b,type:"POST",dataType:"text",scriptCharset:"utf-8",error:function(a,b,e){writeToDebugLog("blacklist error: "+e)},success:function(){showStatusMessage(g_STATUS_SAVE,translate("Address added to BlackList folder"),3E3)}})}
function addToWhitelist(a){var b=getNameAndEmailFieldsFromEmail(a),a="&View=ContactEdit&Create=1&External=Yes&FolderID="+g_WHITELIST_FOLDERID+"&Save=Yes",b="&guid=&mail="+encodeURIComponent(b.email)+"&cn="+encodeURIComponent(b.name);$.ajax({url:wcLink+a,data:b,type:"POST",dataType:"text",scriptCharset:"utf-8",error:function(a,b,e){writeToDebugLog("whitelist error: "+e)},success:function(){showStatusMessage(g_STATUS_SAVE,translate("Address added to whitelist folder"),3E3)}})}
if(typeof console=="undefined")var console={log:function(){}};if(typeof testLog=="undefined")var testLog=function(a){console.log(a)};var g_Browser_Prefix="";is_ie?g_Browser_Prefix="Ms":moz?g_Browser_Prefix="Moz":is_safari?g_Browser_Prefix="Webkit":is_opera&&(g_Browser_Prefix="O");function browserSupports(a){if(this[a])return this[a];var b=document.createElement("div"),c=g_Browser_Prefix+a.substr(0,1).toUpperCase()+a.substr(1);this[a]=a in b.style||c in b.style;return this[a]}var bUseTransforms=browserSupports("transform");
function getNavLeftWidth(a){switch(a){case "da":case "nl":return 115;case "hu":case "sv":case "tr":return 95;default:return 75}}Date.prototype.getISOWeek=function(){var a=new Date(this);for(typeof getSetting!=="undefined"&&parseInt(getSetting("StartOfWeek"),10)===0&&a.getDay()===0&&a.setDate(a.getDate()+1);a.getDay()>1;)a.setDate(a.getDate()-1);var b=new Date(a.getISOYear(),0,1),a=Math.ceil(((a-b)/864E5+b.getMonday()+1)/7);b.getMonday()>3&&--a;return a};
Date.prototype.getTimeString=function(){var a=this.getHours(),b=this.getMinutes(),b=b<10?"0"+b:b;if(g_UseAMPM){var c=a>11?translate("PM"):translate("AM");return((a<10||a>21&&a!==0?"0":"")+a>12?a-12:a===0?"12":a)+":"+b+" "+c}else return a+":"+b};Date.prototype.getMonday=function(){return(this.getDay()+6)%7};Date.prototype.getISOYear=function(){return(new Date(this.getFullYear(),this.getMonth(),this.getDate()+3-this.getMonday())).getFullYear()};
Date.prototype.toMidnight=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0)};Date.prototype.toJustBeforeMidnight=function(){this.setHours(23);this.setMinutes(59);this.setSeconds(59);this.setMilliseconds(999)};Date.prototype.toUTCMilliseconds=function(){return Date.UTC(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getMilliseconds())};
Date.prototype.toEndOfMonth=function(){this.setDate(1);this.toJustBeforeMidnight();this.setMonth(this.getMonth()+1);this.setDate(this.getDate()-1)};Date.prototype.daysBetweenDates=function(a){var b=0,c=new Date(Math.min(this.getTime(),a.getTime())),a=new Date(Math.max(this.getTime(),a.getTime()));c.toJustBeforeMidnight();for(a.toJustBeforeMidnight();c<a;)c.setDate(c.getDate()+1),b++;return b};
Date.prototype.roundToFiveMinutes=function(){this.getMinutes()>56?(this.setHours(this.getHours()+1),this.setMinutes(0)):this.setMinutes(Math.round(this.getMinutes()/5)*5%60)};
